[TOC]

# CH05_Intent

## 显式和隐式Intent

### 知识点

例子：MainActivity中有两个按钮分别通过显式Intent和隐式Intent跳转到NewActivity

重点：

1. 显式Intent的创建方法
2. 隐式Intent的相关属性的作用及使用

​		

### AndroidManifest

~~~java
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="net.onest.intentch0501">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">
        <activity android:name=".AnotherActivity"
            android:label="AnotherActivity">
            <intent-filter>
                <action android:name="net.onest.action.AAA" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <!-- 如果想要NewActivity通过隐式Intent启动，必须配置intent-filter -->
        <activity
            android:name=".NewActivity"
            android:label="NewActivity">
            <intent-filter>
                <!--多个action子元素表示该组件可以被不同的Intent对象启动-->
                <action android:name="net.onest.action.AAA" />
                <action android:name="net.onest.action.BBB"/>
                <!--intent-filter中可以设置多个category子元素-->
                <category android:name="net.onest.category.AAA"/>
                <category android:name="android.intent.category.DEFAULT" />
                 <!--设置data和type-->
                <data android:scheme="data"
                    android:host="net.onest.demo"
                    android:port="1234"
                    android:path="/exm"
                    android:mimeType="language/java"/>

            </intent-filter>
        </activity>
        <activity android:name=".MainActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest>
~~~



### MainActivity

```java
package net.onest.intentch0501;

import androidx.appcompat.app.AppCompatActivity;

import android.content.ComponentName;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = findViewById(R.id.btn_start);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //使用显示Intent（直接指定了要启动的目的组件，即直接指定Component属性）
                Intent intent = new Intent();
                intent.setClass(MainActivity.this,
                        NewActivity.class);
//                intent.setClassName(MainActivity.this,//环境上下文
//                        "net.onest.intentch0501.NewActivity");//目的组件类的全限定名
                //可以启动不同app中的组件
//                intent.setClassName("net.onest.intentch0501",
//                        "net.onest.intentch0501.NewActivity");
//                intent.setClassName("net.onest.activitych0402",
//                        "net.onest.activitych0402.DialogActivity");
//                ComponentName componentName = new ComponentName(
//                        MainActivity.this, NewActivity.class);
//                intent.setComponent(componentName);

//                Intent intent = new Intent(MainActivity.this,
//                        NewActivity.class);
                startActivity(intent);
            }
        });

        Button button1 = findViewById(R.id.btn_intent);
        button1.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //使用隐式Intent（没有直接指定Component属性，
                // 而是指定了action、category，data，type属性等）
                Intent intent = new Intent();
                //描述目的组件具有的特征(1个intent对象只能启动1个目的组件)
                intent.setAction("net.onest.action.AAA");
                //category属性要结合action属性一起使用
                //1个intent对象可以设置多个category字符串
                intent.addCategory("net.onest.category.AAA");
                //设置Data属性"data://net.onest.demo:1234/exm"
                //intent.setData(Uri.parse("data://net.onest.demo:1234/exm"));
                //同时设置Data和Type属性
                intent.setDataAndType(Uri.parse("data://net.onest.demo:1234/exm"),
                        "language/java");
                startActivity(intent);
            }
        });
    }
}

```



### NewActivity

```java
package net.onest.intentch0501;

import androidx.appcompat.app.AppCompatActivity;

import android.content.ComponentName;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class NewActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_new);
        //在目的组件中获取Intent的属性值
        Intent intent = getIntent();
        ComponentName componentName = intent.getComponent();
//        componentName.getPackageName();//包名
//        componentName.getClassName();//类名
        Log.e("NewActivity","包名"+componentName.getPackageName()+"----"
        +"类名"+componentName.getClassName());

        Button jump = findViewById(R.id.btn_jump);
        jump.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //跳转到MainActivity
                Intent intent1 = new Intent(NewActivity.this,
                        MainActivity.class);
                //如果栈内有该activity，则调到栈顶，而不去新建一个activity
                intent1.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(intent1);
            }
        });
    }
}

```



### activity_main.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    xmlns:android="http://schemas.android.com/apk/res/android" >
    <Button
        android:id="@+id/btn_start"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="显式Intent启动Activity"/>

    <Button
        android:id="@+id/btn_intent"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="隐式Intent启动Activity"/>
</LinearLayout>
```

## Intent启动内置应用程序及PendingIntent

### 知识点

1. 使用隐式Intent启动内置应用程序

2. 使用PendingIntent打开应用程序

   #### MainActivity

   ```java
   package net.onest.intentch0502;
   
   import androidx.annotation.RequiresApi;
   import androidx.appcompat.app.AppCompatActivity;
   
   import android.app.Notification;
   import android.app.NotificationChannel;
   import android.app.NotificationManager;
   import android.app.PendingIntent;
   import android.content.Intent;
   import android.net.Uri;
   import android.os.Build;
   import android.os.Bundle;
   import android.view.View;
   import android.widget.Button;
   
   public class MainActivity extends AppCompatActivity {
   
       @Override
       protected void onCreate(Bundle savedInstanceState) {
           super.onCreate(savedInstanceState);
           setContentView(R.layout.activity_main);
           Button btnOpen = findViewById(R.id.btn_open);
           btnOpen.setOnClickListener(new View.OnClickListener() {
               @Override
               public void onClick(View v) {
                   //启动系统内置的应用程序
                   //打开拨号、打电话界面
                   //1.创建Intent对象
   //                Intent intent = new Intent();
   //                //2.设置Intent对象的Action、Data、Type属性
   ////                intent.setAction("android.intent.action.DIAL");
   //                intent.setAction(Intent.ACTION_CALL);
   //                intent.setData(Uri.parse("tel:18332326029"));
   //                //3.启动内置程序中的Activity组件
   //                startActivity(intent);
   
                   //打开发送短信程序
   //                Intent intent = new Intent();
   //                intent.setAction(Intent.ACTION_SENDTO);
   //                intent.setData(Uri.parse("smsto:10086"));
   //                intent.putExtra("sms_body","这是短信的内容");
   //                startActivity(intent);
   
                   //打开内置地图程序
   //                Intent intent = new Intent();
   //                intent.setAction(Intent.ACTION_VIEW);
   //                intent.setData(Uri.parse("geo:39.89,116.3"));
   //                startActivity(intent);
   
                   //打开内置浏览器
                   Intent intent = new Intent();
                   intent.setAction(Intent.ACTION_VIEW);
                   intent.setData(Uri.parse("http://www.baidu.com"));
                   startActivity(intent);
               }
           });
   
           Button btnSend = findViewById(R.id.btn_send);
           btnSend.setOnClickListener(new View.OnClickListener() {
               @RequiresApi(api = Build.VERSION_CODES.JELLY_BEAN)
               @Override
               public void onClick(View v) {
                   //发送通知
                   NotificationManager manager = (NotificationManager)
                           getSystemService(NOTIFICATION_SERVICE);
                   Notification.Builder builder = null;
                   if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {
                       NotificationChannel channel = new NotificationChannel("channel_id",
                               "通知渠道的名称",NotificationManager.IMPORTANCE_DEFAULT);
                       manager.createNotificationChannel(channel);
                       builder = new Notification.Builder(MainActivity.this,"channel_id");
                   }else {
                       builder = new Notification.Builder(MainActivity.this);
                   }
                   builder.setSmallIcon(R.drawable.ball);
                   builder.setContentTitle("标题");
                   builder.setContentText("内容");
                   //期望将来用户点击该通知时，能够启动当前APP，就需要使用PendingIntent
                   Intent intent = new Intent(MainActivity.this,
                           MainActivity.class);
                   PendingIntent pendingIntent = PendingIntent.getActivity(MainActivity.this,
                           100, intent, PendingIntent.FLAG_UPDATE_CURRENT);
                   builder.setContentIntent(pendingIntent);//设置潜在意图
                   Notification notification = builder.build();
                   manager.notify(100,notification);
               }
           });
       }
   }
   
   ```

   

   #### AndroidManifest

   ```xml
   <?xml version="1.0" encoding="utf-8"?>
   <manifest xmlns:android="http://schemas.android.com/apk/res/android"
       package="net.onest.intentch0502">
   
       <!--申请程序所需的权限:(Android6.0以后所有的权限需要在程序中动态申请获得用户的授权)-->
       <uses-permission android:name="android.permission.CALL_PHONE"/>
   
       <application
           android:allowBackup="true"
           android:icon="@mipmap/ic_launcher"
           android:label="@string/app_name"
           android:roundIcon="@mipmap/ic_launcher_round"
           android:supportsRtl="true"
           android:theme="@style/AppTheme">
           <activity android:name=".MainActivity">
               <intent-filter>
                   <action android:name="android.intent.action.MAIN" />
                   <category android:name="android.intent.category.LAUNCHER" />
               </intent-filter>
           </activity>
       </application>
   
   </manifest>
   ```

   



# CH_04Activity

## Activity的创建和跳转

MainActivity向NewActivity跳转并传递数据，NewActivity得到Intent中的数据，显示，并修改，将修改后的数据返回给MainActivity，MainActivity处理响应事件

### MainActivity

~~~java
package com.example.ch04_01activity;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;

import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class MainActivity extends AppCompatActivity {
private String[] names={"张三","李四","王五"};
private ArrayAdapter arrayAdapter;
private  int nowPosition;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //使用ListView显示数据
        ListView listView=findViewById(R.id.lv);
        arrayAdapter=new ArrayAdapter(this,android.R.layout.simple_expandable_list_item_1,names);
        listView.setAdapter(arrayAdapter);
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                //1.新建intent
                Intent intent=new Intent();
                nowPosition=position;
                //2.设置目的地
                intent.setClass(MainActivity.this,NewActivity.class);
//                //方式一:传递数据,跳转,
//                intent.putExtra("name",names[position]);
//                intent.putExtra("phone","121212154");
//                intent.putExtra("email","45486097@qq.com");
                //方式二：Bundle，把所有数据都加入到bundle中，bundle一捆数据
//                Bundle bundle=new Bundle();
//                bundle.putString("name",names[position]);
//                bundle.putString("phone","15485");
//                bundle.putString("email","54548");
//                intent.putExtra("bundle",bundle);
                //方式三：获取自定义类型的数据
                Student student=new Student("战三","115","4848");
                intent.putExtra("student",student);
                //3.跳转到新的activity
                startActivity(intent);//不传递数据，不需要返回相应
//                startActivityForResult(intent,100);//请求码：区分哪次的请求，需要返回响应


            }
        });
    }
//    //回调方法，在startActivityForResult后自动调用，接收响应的数据，并且刷新数据
//
//    @Override
//    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
//        //requestCode跳转时的请求码100
//        //resultCode响应码200
//        //data返回响应的Intent对象
//        super.onActivityResult(requestCode, resultCode, data);
//        if(requestCode==100&&resultCode==200){
//            String name=data.getStringExtra("name");
//            //要修改，还要知道position的值
//            names[nowPosition]=name;
//            //刷新ListView
//            arrayAdapter.notifyDataSetChanged();
//        }
//    }
}

~~~

### NewActivity

~~~java
package com.example.ch04_01activity;

import android.content.Intent;
import android.os.Bundle;
import android.os.PersistableBundle;
import android.util.Log;
import android.view.View;
import android.widget.EditText;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;

public class NewActivity extends AppCompatActivity {
    EditText etName;//此处不能findViewById，没有加载布局文件呢
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_new);
        //获取控件
       etName=findViewById(R.id.et_name);
        EditText etPhone=findViewById(R.id.et_phone);
        EditText etEmail=findViewById(R.id.et_email);
        //1.使用intent接收传递的数据
          Intent request=getIntent();//得到启动时的intent对象，即mainactivity的intent对象
//        String name=request.getStringExtra("name");
//        String phone=request.getStringExtra("phone");
//        String email=request.getStringExtra("email");
        //2.借助于bundle传递参数
//        Bundle bundle=request.getBundleExtra("bundle");
//        String name=bundle.getString("name");
//        String phone=bundle.getString("phone");
//        String email=bundle.getString("email");
//        etName.setText(name);
//        etPhone.setText(phone);
//        etEmail.setText(email);
        //3.获取自定义数据类型
        //序列化的接口类型，转化为student类型
        Student stu=(Student) request.getSerializableExtra("student");
        etName.setText(stu.getName());
        etPhone.setText(stu.getPhone());
        etEmail.setText(stu.getEmail());
        Log.e("name", "onCreate: "+stu.getName() );

    }
//    public void btnClick(View v){
//        //返回数据
//        Intent response=new Intent();
//        response.putExtra("name",etName.getText().toString());
//        //响应
//        setResult(200,response);
//        //结束当前的NewActivity
//        this.finish();
//    }

}

~~~

### Student类

```java
package com.example.ch04_01activity;

import java.io.Serializable;

//使用intent传递该类型对象，该类应实现Serializable接口
public class Student implements Serializable {
    String name;
    String phone;
    String email;

    public Student(String name, String phone, String email) {
        this.name = name;
        this.phone = phone;
        this.email = email;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPhone() {
        return phone;
    }

    public void setPhone(String phone) {
        this.phone = phone;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }
}

```

### activity_main.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<ListView android:layout_width="match_parent"
    android:id="@+id/lv"
    android:layout_height="match_parent"
    xmlns:android="http://schemas.android.com/apk/res/android" />
```

### activity_new.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="姓名："
        android:textSize="25sp"/>
    <EditText
        android:id="@+id/et_name"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>
</LinearLayout>
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="电话："
            android:textSize="25sp"/>
        <EditText
            android:id="@+id/et_phone"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"/>
    </LinearLayout>
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="邮箱："
            android:textSize="25sp"/>
        <EditText
            android:id="@+id/et_email"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"/>
    </LinearLayout>
<!--    <Button-->
<!--        android:id="@+id/btn_save"-->
<!--        android:layout_width="match_parent"-->
<!--        android:layout_height="wrap_content"-->
<!--        android:text="保存"-->
<!--        android:onClick="btnClick"/>-->
</LinearLayout>
```

# CH02_高级用户组件

## AdapterView

### 1.基本

显示单一字符串

#### MainActivity

```java
package net.onest.arrayadapterch0203;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //ListView使用步骤：
        //1.准备数据源
        String[] names = {"Android基础开发","Android高级编程","Android综合应用"};
        //2.准备item的布局文件（SDK自带的布局文件）
        //3.选择一种Adapter，绑定Adapter
        ArrayAdapter<String> myAdapter = new ArrayAdapter<String>(this,//环境上下文
                android.R.layout.simple_list_item_1,//item的布局文件
                names);//数据源
        ListView nameListView = findViewById(R.id.lv_names);
        nameListView.setAdapter(myAdapter);
        //4.给ListView设置item点击事件的监听器
        nameListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                //parent是ListView对象
                //view是点击的item的视图对象
                //position是点击的item的位置，从0开始
                Log.e("点击ListView中position",position + "条");
                Log.e("点击ListView中id",id + "条");
                view.setBackgroundColor(getResources().getColor(android.R.color.holo_red_dark));
            }
        });
    }
}

```

#### XML

```java
<?xml version="1.0" encoding="utf-8"?>
<ListView
    android:id="@+id/lv_names"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    xmlns:android="http://schemas.android.com/apk/res/android" />

```

### 2.拓展

显示：申亚雨
			2018011886

#### MainActivity

```java
package net.onest.simpleadapterch0203;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.widget.ListView;
import android.widget.SimpleAdapter;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //1.准备数据源
        List<Map<String, String>> students = new ArrayList<>();
        Map<String, String> stu1 = new HashMap<>();
        stu1.put("name", "张三");
        stu1.put("stuNo", "2018011785");
        Map<String, String> stu2 = new HashMap<>();
        stu2.put("name","李四");
        stu2.put("stuNo","2018011786");
        students.add(stu1);
        students.add(stu2);
        //2.准备item布局文件(自带的布局文件)
        //3.创建Adapter，绑定Adapter
        SimpleAdapter myAdapter = new SimpleAdapter(this,//环境上下文
                students,//数据源
                android.R.layout.simple_list_item_2,//item的布局文件
                new String[]{"name","stuNo"},//数据源中Map的key值
                new int[]{android.R.id.text1, android.R.id.text2});//item布局当中显示内容的控件的id

        ListView studentListView = findViewById(R.id.lv_student);
        studentListView.setAdapter(myAdapter);
        //4.设置ListView的监听器
    }
}

```

#### XML

```java
<?xml version="1.0" encoding="utf-8"?>
<ListView
    android:id="@+id/lv_student"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    xmlns:android="http://schemas.android.com/apk/res/android" />
```

### 3.高阶

显示：图片   申亚雨

​						2018011883

#### 1.自定义数据源Student类

```java
package net.onest.customadapterch0203;

public class Student {
    private String name;
    private String stuNo;
    private int photoId;

    public Student() {
    }

    public Student(String name, String stuNo, int photoId) {
        this.name = name;
        this.stuNo = stuNo;
        this.photoId = photoId;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getStuNo() {
        return stuNo;
    }

    public void setStuNo(String stuNo) {
        this.stuNo = stuNo;
    }

    public int getPhotoId() {
        return photoId;
    }

    public void setPhotoId(int photoId) {
        this.photoId = photoId;
    }
}

```

#### 2.自定义Adapter类

```java
package net.onest.customadapterch0203;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

import java.util.ArrayList;
import java.util.List;

public class CustomAdapter extends BaseAdapter {
    private Context mContext;
    private List<Student> students = new ArrayList<>();
    private int itemLayoutRes;

    public CustomAdapter(Context mContext, List<Student> students, int itemLayoutRes) {
        this.mContext = mContext;
        this.students = students;
        this.itemLayoutRes = itemLayoutRes;
    }

    @Override
    public int getCount() {//获得数据的条数
        if (null != students){
            return students.size();
        }
        return 0;
    }

    @Override
    public Object getItem(int position) {//获取每个item显示的数据对象
        if (null != students){
            return students.get(position);
        }
        return null;
    }

    @Override
    public long getItemId(int position) {//获取每个item的id值
        return position;
    }

    @Override
    //获取item的视图对象
    public View getView(final int position, View convertView, ViewGroup parent) {
        //convertView每个item的视图对象
        //1.加载item的布局文件
        if (convertView == null) {
            LayoutInflater inflater = LayoutInflater.from(mContext);//布局填充器
            convertView = inflater.inflate(itemLayoutRes, null);
        }

        //2.获取item中控件的引用
        ImageView ivPhoto = convertView.findViewById(R.id.iv_photo);
        TextView tvName = convertView.findViewById(R.id.tv_name);
        TextView tvNo = convertView.findViewById(R.id.tv_no);
        Button btnDelete = convertView.findViewById(R.id.btn_delete);

        //3.设置控件内容
        ivPhoto.setImageResource(students.get(position).getPhotoId());
        tvName.setText(students.get(position).getName());
        tvNo.setText(students.get(position).getStuNo());

        //4.设置控件事件监听器
        btnDelete.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //从数据源中删除某条数据
                students.remove(position);
                //更新Adapter
                notifyDataSetChanged();
            }
        });

        return convertView;
    }
}

```

#### 3.自定义item布局

~~~java
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:descendantFocusability="blocksDescendants">

    <ImageView
        android:id="@+id/iv_photo"
        android:layout_width="100dp"
        android:layout_height="100dp"/>

    <LinearLayout
        android:layout_toRightOf="@id/iv_photo"
        android:layout_centerVertical="true"
        android:layout_gravity="center_vertical"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical">

        <TextView
            android:id="@+id/tv_name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="25sp"/>

        <TextView
            android:id="@+id/tv_no"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="20sp"/>
    </LinearLayout>

</RelativeLayout>
~~~



#### MainActivity

```java
package net.onest.customadapterch0203;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;

import java.util.ArrayList;
import java.util.List;

public class MainActivity extends AppCompatActivity {

    private List<Student> students = new ArrayList<>();
    private CustomAdapter customAdapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

        //1.准备数据
        initData();
        //2.定义item布局文件(自定义)
        //3.创建Adapter，绑定Adapter
        initView();
        //4.设置监听器

        //5.添加学生，让数据显示，根据数据源的变化而变化
        addStudent();
    }
    public void initView(){
        customAdapter = new CustomAdapter(this, students,
                R.layout.student_list_item);
        ListView stuListView = findViewById(R.id.lv_student);
        stuListView.setAdapter(customAdapter);
        stuListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                //打印选中的学生的姓名
                Log.e("选中的学生姓名",students.get(position).getName());
            }
        });
    }

    public void initData(){
        Student stu1 = new Student("张三","2018011785",R.drawable.boy);
        Student stu2 = new Student("李四","20180011786",R.drawable.girl);
        Student stu3 = new Student("张三","2018011785",R.drawable.boy);
        Student stu4 = new Student("李四","20180011786",R.drawable.girl);
        Student stu5 = new Student("张三","2018011785",R.drawable.boy);
        Student stu6 = new Student("李四","20180011786",R.drawable.girl);
        students.add(stu1);
        students.add(stu2);

    }

    public void addStudent(){
        Button btnAdd = findViewById(R.id.btn_add);
        btnAdd.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //添加学生
                Student stu = new Student("王五","2018011787",R.drawable.boy);
                //修改数据源
                students.add(stu);
                //更新Adapter
                customAdapter.notifyDataSetChanged();
            }
        });
    }
}

```

### 4.ListView---->GridView

数据源不变

自定义Adapter不变

只改变主布局文件的ListView---->GridView

```java
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    xmlns:android="http://schemas.android.com/apk/res/android" >
    <GridView
        android:id="@+id/gv_student"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:numColumns="auto_fit"
        xmlns:android="http://schemas.android.com/apk/res/android" />
</LinearLayout>
```

### 5.Spinner下拉列表

两种使用方法：

#### 1.使用Adapter

```java
 public void initSpinner(){
        String[] citys = {"北京","上海","深圳"};
        ArrayAdapter myAdapter = new ArrayAdapter(this,
                android.R.layout.simple_list_item_1,
                citys);
        Spinner spCity = findViewById(R.id.sp_city);
        spCity.setAdapter(myAdapter);
    }
}
```

#### 2.entries属性

先定义资源文件

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <array name="courcenames">
        <item>面向对象程序设计</item>
        <item>数据结构</item>
        <item>网络原理</item>
    </array>
</resources>
```

```xml
    <Spinner
        android:id="@+id/sp_course"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:entries="@array/courcenames"/><!--使用entries就不需要定义Adapter了-->
```

## TabHost

### 1.MainActivity

```java
package net.onest.tabhostch0203;

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.util.Log;
import android.widget.TabHost;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //1.获取到TabHost引用
        TabHost tabHost = findViewById(android.R.id.tabhost);
        //2.初始化tabHost
        tabHost.setup();
        //3.创建TabSpec页面
        TabHost.TabSpec tab1 = tabHost.newTabSpec("message_tab")
                .setIndicator("短信")//选项按钮显示的文字
                .setContent(R.id.tab1);//短信页面对应的布局

        TabHost.TabSpec tab2 = tabHost.newTabSpec("contact_tab")
                .setIndicator("联系人")
                .setContent(R.id.tab2);

        //4.把tabspec添加到tabhost
        tabHost.addTab(tab1);
        tabHost.addTab(tab2);

        //5.给TabHost添加监听器
        tabHost.setOnTabChangedListener(new TabHost.OnTabChangeListener() {
            @Override
            public void onTabChanged(String tabId) {//当切换选项按钮时调用
                Log.e("切换选项",tabId);
            }
        });
    }
}

```

### 2.XML文件

```xml
<?xml version="1.0" encoding="utf-8"?>
<!--  界面整体，id的值不可变  -->
<TabHost
    android:id="@android:id/tabhost"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    xmlns:android="http://schemas.android.com/apk/res/android" >
    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent">
        <!-- 选项标签栏 id值不可变-->
        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"/>
        <!-- 具体的内容页-->
        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_above="@android:id/tabs">

            <!--第一个页面布局-->
            <LinearLayout
                android:id="@+id/tab1"
                android:layout_width="match_parent"
                android:layout_height="match_parent">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="这是第一个页面"
                    android:textSize="25sp"/>
            </LinearLayout>

            <!--第二个页面布局-->
            <LinearLayout
                android:id="@+id/tab2"
                android:layout_width="match_parent"
                android:layout_height="match_parent">
                <TextView
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="这是第二个页面"
                    android:textSize="25sp"/>
            </LinearLayout>
        </FrameLayout>
    </RelativeLayout>
</TabHost>
```

## FragmentTabHost

### 1.基本

标签是一个字符串

#### 主XML

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<androidx.fragment.app.FragmentTabHost
    android:id="@android:id/tabhost"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    xmlns:android="http://schemas.android.com/apk/res/android" >

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent">
        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"/>
        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_above="@android:id/tabs"/>
    </RelativeLayout>
</androidx.fragment.app.FragmentTabHost>
~~~

#### Fragment的布局

生活中有几个fragment就写几个，一个布局对应一个fragment的类

```xml
<?xml version="1.0" encoding="utf-8"?>
<!--选项内容页面的布局文件-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="match_parent"
    android:layout_height="match_parent">

    <TextView
        android:id="@+id/tv_content"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="30sp"
        android:textColor="#008577"/>

</LinearLayout>
```



#### Fragment类（有几个fragment就写几个）

FirstFragment

```java
package net.onest.fragmenttabhostch0203.fragment;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;

import net.onest.fragmenttabhostch0203.R;

//第一个内容页面对应的Fragment类
public class FirstFragment extends Fragment {
    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        //加载内容页面的布局文件（将内容页面的XML布局文件转成View类型的对象）
        View view = inflater.inflate(R.layout.fragment_layout,//内容页面的布局文件
                container,//根视图对象
                false);//false表示需要手动调用addView方法将view添加到container
                                     //true表示不需要手动调用addView方法

        //获取内容页面当中控件的引用
        TextView tvContent = view.findViewById(R.id.tv_content);
        tvContent.setText("这是第一个内容页面");

        return view;
    }
}

```



SecondFragment

```java
package net.onest.fragmenttabhostch0203.fragment;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;

import net.onest.fragmenttabhostch0203.R;

public class SecondFragment extends Fragment {
    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_layout,//内容页面的布局文件
                container,//根视图对象
                false);

        //获取内容页面当中控件的引用
        TextView tvContent = view.findViewById(R.id.tv_content);
        tvContent.setText("这是第二个内容页面");

        return view;
    }
}

```

#### MainActivity

~~~java
package net.onest.fragmenttabhostch0203;

import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.FragmentTabHost;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.ImageView;
import android.widget.TabHost;
import android.widget.TextView;

import net.onest.fragmenttabhostch0203.fragment.FirstFragment;
import net.onest.fragmenttabhostch0203.fragment.SecondFragment;

import java.util.HashMap;
import java.util.Map;

public class MainActivity extends AppCompatActivity {

    private Map<String, ImageView> imageViewMap = new HashMap<>();
    private Map<String, TextView> textViewMap = new HashMap<>();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //获取FragmentTabHost的引用
        FragmentTabHost fragmentTabHost = findViewById(android.R.id.tabhost);
        //初始化
        fragmentTabHost.setup(this,
                getSupportFragmentManager(),//管理多个Fragment对象的管理器
                android.R.id.tabcontent);//显示内容页面的控件的id

        //创建内容页面TabSpec对象
        TabHost.TabSpec tab1 = fragmentTabHost.newTabSpec("first_tab")
                .setIndicator(getTabSpecView("first_tab","短信",R.drawable.message));
//                .setIndicator("短信");
        //Class参数：类名.class,对象.getClass()
        fragmentTabHost.addTab(tab1,
                FirstFragment.class,//FristFragment类的Class（字节码）对象
                null);//传递数据时使用，不需要传递数据直接传null

        TabHost.TabSpec tab2 = fragmentTabHost.newTabSpec("second_tab")
                .setIndicator(getTabSpecView("second_tab","联系人",R.drawable.contact));
//                .setIndicator("联系人");
        fragmentTabHost.addTab(tab2,
                SecondFragment.class,//SecondFragment类的Class对象
                null);

        //处理fragmentTabHost的选项切换事件
        fragmentTabHost.setOnTabChangedListener(new TabHost.OnTabChangeListener() {
            @Override
            public void onTabChanged(String tabId) {
                //修改图片和文字的颜色
                switch (tabId){
                    case "first_tab"://选中了短信
                        imageViewMap.get("first_tab").setImageResource(R.drawable.message1);
                        imageViewMap.get("second_tab").setImageResource(R.drawable.contact);
                        break;
                    case "second_tab"://选中了联系人
                        imageViewMap.get("first_tab").setImageResource(R.drawable.message);
                        imageViewMap.get("second_tab").setImageResource(R.drawable.contact1);
                        break;
                }
            }
        });

        //设置默认选中的标签页:参数是下标
        fragmentTabHost.setCurrentTab(0);
        imageViewMap.get("first_tab").setImageResource(R.drawable.message1);
        //setTextColor不能直接传入color资源的id号
        textViewMap.get("first_tab").setTextColor(getResources().getColor(android.R.color.black));
    }
    
	//得到标签的布局的方法
    public View getTabSpecView(String tag, String tilte, int drawable){
        View view = getLayoutInflater().inflate(R.layout.tab_spec_layout,null);

        //获取tab_spec_layout布局当中视图控件的引用
        ImageView icon = view.findViewById(R.id.icon);
        icon.setImageResource(drawable);

        //将ImageView对象存储到Map中
        imageViewMap.put(tag,icon);

        TextView tvTitle = view.findViewById(R.id.title);
        tvTitle.setText(tilte);

        textViewMap.put(tag,tvTitle);

        return view;
    }
}

~~~

### 2.提升

标签的布局自定义

~~~java
  .setIndicator("短信");
//转化为
  .setIndicator(getTabSpecView("second_tab","联系人",R.drawable.contact));

~~~

#### 自定义标签布局

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center">

    <ImageView
        android:id="@+id/icon"
        android:layout_width="40dp"
        android:layout_height="40dp"/>
    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
</LinearLayout>
~~~

### 3.优化

为每一个标签设置点击事件，点击后黑色变成蓝色

代码在上

## AlertDialog

### 知识点



1. 简单的AlertDialog
2. 自定义message的AlertDialog
3. 使用DialogFragment实现完全自定义的弹出框包括标题、内容、按钮

### 1.弹出简单的AlertDialog

例子：在主布局定义几个按钮，点击按钮打开不同的对话框和弹出框



![image-20200603095006723](C:\Users\ShenYayu\AppData\Roaming\Typora\typora-user-images\image-20200603095006723.png)

![image-20200603095047085](C:\Users\ShenYayu\AppData\Roaming\Typora\typora-user-images\image-20200603095047085.png)

#### 主布局xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:id="@+id/root"
    xmlns:android="http://schemas.android.com/apk/res/android" >
    <Button
        android:id="@+id/btn_alertdialog"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="弹出基础对话框"/>
    <Button
        android:id="@+id/btn_custom_message"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="弹出自定义Message对话框"/>
    <Button
        android:id="@+id/btn_custom_dialog"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="弹出完全自定义布局对话框"/>
    <Button
        android:id="@+id/btn_popup"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="弹出PopupWindow"/>
</LinearLayout>
```

#### MainActivity

```java
package net.onest.alertdialogch0204;

import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;

import android.app.AlertDialog;
import android.app.Dialog;
import android.content.DialogInterface;
import android.os.Bundle;
import android.util.Log;
import android.view.Gravity;
import android.view.View;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.LinearLayout;
import android.widget.PopupWindow;
import android.widget.TextView;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        MyListener myListener = new MyListener();

        Button btnAlertDialog = findViewById(R.id.btn_alertdialog);
        //单独定义内部类实现监听器类
        btnAlertDialog.setOnClickListener(myListener);
        Button btnCustomMessage = findViewById(R.id.btn_custom_message);
        btnCustomMessage.setOnClickListener(myListener);
        Button btnCustomDialog = findViewById(R.id.btn_custom_dialog);
        btnCustomDialog.setOnClickListener(myListener);
        Button btnPopup = findViewById(R.id.btn_popup);
        btnPopup.setOnClickListener(myListener);
    }

    private class MyListener implements View.OnClickListener{

        @Override
        public void onClick(View v) {
            switch (v.getId()){
                case R.id.btn_alertdialog://处理btnAlertDialog按钮的点击事件
                    //弹出基础对话框
                    showAlertDialog();
                    break;
                case R.id.btn_custom_message:
                    //弹出自定义Message对话框
                    showCustomMessageDialog();
                    break;
                case R.id.btn_custom_dialog:
                    //弹出完全自定义布局对话框
                    showCustomDialog();
                    break;
                case R.id.btn_popup:
                    //弹出PopupWindow
                    showPopupWindow();
                    break;
            }
        }
    }

    private void showAlertDialog(){
        //创建Builder对象
//        AlertDialog.Builder builder = new AlertDialog.Builder(this);
//        //设置对话框属性
//        builder.setTitle("温馨提示");//标题
//        builder.setMessage("确定要退出这个应用程序吗");//显示的提示内容
//        builder.setNegativeButton("取消",null);//设置取消按钮
//        builder.setPositiveButton("确定", new DialogInterface.OnClickListener() {
//            @Override
//            public void onClick(DialogInterface dialog, int which) {
//                //退出当前的Activity
//                finish();
//            }
//        }); //设置确定按钮
//        //创建对话框对象
//        AlertDialog alertDialog = builder.create();
//        //显示对话框
//        alertDialog.show();

        //方法链调用
        new AlertDialog.Builder(this).setTitle("温馨提示")
                .setMessage("确定要退出这个应用程序吗")
                .setNegativeButton("取消",null)
                .setPositiveButton("确定", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        finish();
                    }
                }).create().show();
    }

    private void showCustomMessageDialog(){

        //创建Builder对象
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        //设置标题
        builder.setTitle("提高“我的位置”的精确度");
        //设置内容(内容视图的布局加载到内存)
        View view = getLayoutInflater().inflate(R.layout.meaage_layout, null);
        //设置布局当中的控件的属性
        TextView tvMessage = view.findViewById(R.id.tv_message);
        tvMessage.setText("为了提高精确度，请打开手机GPS");
        final CheckBox checkBox = view.findViewById(R.id.checkbox);
        checkBox.setText("不再显示此内容");
        //把内容视图添加到对话框
        builder.setView(view);
        //设置取消和确定按钮
        builder.setNegativeButton("取消",null);
        builder.setPositiveButton("去设置", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int which) {
                //判断复选框是否被选中
                if (checkBox.isChecked()){
                    Log.e("复选框","被选中");
                }else {
                    Log.e("复选框","未被选中");
                }
            }
        });
        AlertDialog alertDialog = builder.create();
        alertDialog.show();
    }

    private void showCustomDialog(){
        //使用FragmentManager显示Fragment
        FragmentManager manager = getSupportFragmentManager();
        //事务(一组原子性的操作，需要提交以后生效)
        FragmentTransaction transaction = manager.beginTransaction();
        CustomDialog dialog = new CustomDialog();//创建Fragment类的对象
        //添加Fragment
        if (!dialog.isAdded()) {//判断是否被添加过，防止重复添加
            transaction.add(dialog, "dialog_tag");
        }
        //显示Fragment
        transaction.show(dialog);
        //提交事务
        transaction.commit();
    }

    private void showPopupWindow(){
         //创建PopupWindow对象
        final PopupWindow popupWindow = new PopupWindow(this);
        //设置弹出窗口的宽度
        popupWindow.setWidth(LinearLayout.LayoutParams.MATCH_PARENT);
        //设置它的视图
        View view = getLayoutInflater().inflate(R.layout.popupwindow,null);
        //设置视图当中控件的属性和监听器
        Button btnCancel = view.findViewById(R.id.btn_cancel);
        btnCancel.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //关闭弹出窗
                popupWindow.dismiss();
            }
        });
        popupWindow.setContentView(view);
        //显示PopupWindow(必须指定显示的位置)
        LinearLayout root = findViewById(R.id.root);
        popupWindow.showAtLocation(root, Gravity.CENTER,0,0);
    }
}

```

### 2.message自定义的AlertDialog

#### message的xml文件

~~~xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="20dp">

    <TextView
        android:id="@+id/tv_message"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="18sp"/>

    <CheckBox
        android:id="@+id/checkbox"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>

</LinearLayout>
~~~

#### java代码见上

### 3.完全自定义的对话框

#### 自定义对话框的xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="30dp">

    <TextView
        android:id="@+id/tv_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="30sp"/>

    <TextView
        android:id="@+id/tv_content"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:textSize="25sp"/>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:layout_marginTop="20dp">
        <Button
            android:id="@+id/btn_ok"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_toLeftOf="@id/btn_cancel"
            android:text="确定"/>
        <Button
            android:id="@+id/btn_cancel"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_marginRight="20dp"
            android:text="取消"/>
    </RelativeLayout>
</LinearLayout>
```

#### DialogFragment

```java
package net.onest.alertdialogch0204;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.DialogFragment;

public class CustomDialog extends DialogFragment {
    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        //加载自定义的对话框布局文件
        View view = inflater.inflate(R.layout.custom_dialog,container,false);
        //设置对话框的属性
        TextView tvTitle = view.findViewById(R.id.tv_title);
        tvTitle.setText("这是对话框标题");
        TextView tvContent = view.findViewById(R.id.tv_content);
        tvContent.setText("这是对话框的提示消息");
        //设置对话框中按钮的点击事件监听器
        Button btnOk = view.findViewById(R.id.btn_ok);//确定按钮
        btnOk.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //关闭当前对话框
                getDialog().dismiss();
            }
        });
        return view;
    }
}

```

##### java代码见上

### 4.PopupWindow

#### xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/transparent">
    <!--背景颜色透明transparent-->

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:layout_alignParentBottom="true"
        android:padding="10dp">

        <Button
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@android:color/white"
            android:text="拍照"/>
        <Button
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@android:color/white"
            android:text="从相册选择"
            android:layout_marginTop="5dp"/>
        <Button
            android:id="@+id/btn_cancel"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@android:color/white"
            android:layout_marginTop="10dp"
            android:text="取消"/>
    </LinearLayout>
</RelativeLayout>
```

#### java代码见上

## Toast、通知消息、选项菜单、上下文菜单、弹出菜单、ActionBar

### 1.Toast

#### MainActivity

```java
package com.example.toastandnotificationtest;

import androidx.annotation.NonNull;
import androidx.annotation.RequiresApi;
import androidx.appcompat.app.ActionBar;
import androidx.appcompat.app.AppCompatActivity;
import androidx.appcompat.widget.Toolbar;
import android.app.Notification;
import android.app.NotificationChannel;
import android.app.NotificationManager;
import android.content.ClipData;
import android.content.ClipboardManager;
import android.content.Context;
import android.graphics.BitmapFactory;
import android.os.Build;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.Gravity;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.PopupMenu;
import android.widget.TextView;
import android.widget.Toast;


public class MainActivity extends AppCompatActivity {
    private long exitTime;
    TextView tv;
    EditText et;
    Button popubMenu;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button toast = findViewById(R.id.btn_toast);
        Button notification = findViewById(R.id.btn_notification);
        MyListener myListener = new MyListener();
        toast.setOnClickListener(myListener);
        notification.setOnClickListener(myListener);

        //四、3.注册上下文菜单registerForContextMenu()
        tv = findViewById(R.id.tv);
        et = findViewById(R.id.et);
        registerForContextMenu(tv);
        registerForContextMenu(et);

        //五、
        popubMenu = findViewById(R.id.btn_popubMenu);
        popubMenu.setOnClickListener(myListener);

        /*
        六、标题栏ActionBar、ToolBar
        1.在mainActivity对应的屏幕界面隐藏ActionBar
        2.ToolBar也可以实现标题栏，所有的activity都隐藏ActionBar
            (0)在style.xml中改成NoActionBar
            (1)在主布局文件中加ToolBar
            (2)设置title等
            (3)setSupportActionBar(toolbar)
         */
        //隐藏Actionbar
//        ActionBar actionBar=getSupportActionBar();
//        actionBar.hide();
        Toolbar toolbar=findViewById(R.id.tool_bar);
        setSupportActionBar(toolbar);
        toolbar.setNavigationOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //页面导航
            }
        });
    }

    /*
    自定义监听器类内部类
     */
    private class MyListener implements View.OnClickListener {

        @RequiresApi(api = Build.VERSION_CODES.O)
        @Override
        public void onClick(View v) {
            switch (v.getId()) {
                case R.id.btn_toast:
                    Toast toast = Toast.makeText(MainActivity.this, "输入信息不合法", Toast.LENGTH_SHORT);
                    toast.setGravity(Gravity.CENTER, 0, 0);
                    toast.show();
                    break;
                case R.id.btn_notification:
                    sendNotification();
                    break;
                case R.id.btn_popubMenu:
                    showPopubMenu();
                    break;
            }
        }
    }

    /*一、toast实现，点击退出，提醒，两次间隔小于2s则退出应用程序
     */
    //任意按钮点击事件

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {//识别按钮
            if (System.currentTimeMillis() - exitTime > 2000) {//识别间隔时间
                Toast.makeText(this, "再次点击退出", Toast.LENGTH_SHORT).show();
                exitTime = System.currentTimeMillis();
            } else {
                this.finish();
            }
        }
        return true;
    }

    /**
     * 二、通知，notification
     * 1.添加事件和监听器，注册监听器
     * 2.发送通知的方法
     * （1）获取通知管理器服务NotificationManager，system service，同剪切板一样，属于系统服务
     * ！获取系统服务的方法
     * NotificationManager作用：绑定channnel、发送通知
     * (2)创建通知渠道NotificationChannel
     * !判定当前版本问题，及修改方法
     * (3)创建通知构造器Notification.Builder ,并设置四个属性，标题，内容，大图标，小图标?构建者模式
     * (4)通过builder.builder创建通知
     * (5)通过notificationManager.notify(),发送通知
     */

    private boolean sendNotification() {
        Notification.Builder builder;
        //获取通知管理器服务（NotificationManager）；是一个系统服务system service
        NotificationManager notificationManager = (NotificationManager) getApplicationContext().getSystemService(Context.NOTIFICATION_SERVICE);
        //创建通知渠道（NotificationChannel）
        NotificationChannel notificationChannel = null;
        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {//判断当前系统版本时候大于26
            notificationChannel = new NotificationChannel(
                    "channel",
                    "重要的通知推送",//通知渠道，跟随安卓系统更新，在设置中可以设置取消一些不感兴趣的渠道的通知
                    NotificationManager.IMPORTANCE_DEFAULT);//在设置中可以看到，这是接收推送信息的行为，提示音，显示等
            notificationManager.createNotificationChannel(notificationChannel);
            //创建通知构造器（Notification.Builer）；
            builder = new Notification.Builder(this, "channel");//如果版本高于26，则创建channel
        } else {
            builder = new Notification.Builder(this);//如果版本低于26，则不创建channel
        }
        builder.setSmallIcon(R.drawable.ic_launcher_background)//builder 设置通知的属性
                .setContentTitle("这是通知标题")
                .setContentText("这是标题内容")
                .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.drawable.large));

        //通过通知构造器创建通知（Notification）；
        Notification notification = builder.build();
        //调用通知管理器服务发送通知。
        notificationManager.notify(1, notification);
        return true;
    }

    /**
     * 三、optionmenu选项菜单,右上方的三个点
     * 1.添加menu布局文件
     * 2.重写自动调用的onCreateOptionsMenu(),加载布局文件
     * 3.重写onOptionsItemSelected(),方法，处理选项点击事件
     */
    @Override
    //创建选项菜单时自动调用
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater menuInflater = getMenuInflater();
        menuInflater.inflate(R.menu.menu, menu);
        return super.onCreateOptionsMenu(menu);
    }

    @Override
    public boolean onOptionsItemSelected(@NonNull MenuItem item) {
        switch (item.getItemId()) {
            case R.id.option1:
                Toast.makeText(this, "选择了选项一", Toast.LENGTH_SHORT).show();
                break;
            case R.id.option2:
                Toast.makeText(this, item.getTitle(), Toast.LENGTH_SHORT).show();
                break;
        }
        return super.onOptionsItemSelected(item);
    }

    /**
     * 四，上下文菜单，复制粘贴
     * 1.创建context_menu.xml,在主布局文件，添加控件，用于粘贴和复制
     * 2.在mainactivity中重写两个方法
     * 3.获取控件引用，注册上下文菜单registerForContextMenu()
     */

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        getMenuInflater().inflate(R.menu.context_menu, menu);
    }

    @Override
    public boolean onContextItemSelected(@NonNull MenuItem item) {
        //复制粘贴，是系统服务，获取剪切板的系统服务
        ClipboardManager clipboardManager = (ClipboardManager) getSystemService(Context.CLIPBOARD_SERVICE);
        switch (item.getItemId()) {
            case R.id.copy:
                String resource = tv.getText().toString();
                //将数据转化为clipdata类型
                ClipData clipData = ClipData.newPlainText("lable", resource);
                //将数据放入剪切板
                clipboardManager.setPrimaryClip(clipData);

                break;
            case R.id.paste:
                //将数据从剪切板取出
                ClipData pasteData = clipboardManager.getPrimaryClip();
                //将字符串取出
                String result = pasteData.getItemAt(0).getText().toString();
                et.setText(result);
                break;
        }
        return super.onContextItemSelected(item);
    }

    /*
    五、PopupMenu
    知识点：
    1.ge1.ApplicatonContext(),整个应用程序的上下文，一个应用程序可以有多个Activity
      context()，一个Acivity的上下文
    2.ManuInflater加载一个菜单资源问文件
      LayoutInflater加载一个布局资源文件
    步骤：
    1.新建Popupmenu
    2.加载菜单资源文件填充菜单对象
    3.处理事件监听
    4.显示PopubMenu
     */
    private void showPopubMenu() {
        //1.新建Popupmenu
        PopupMenu popupMenu = new PopupMenu(this, popubMenu);
        //2.加载菜单资源文件填充菜单对象
        getMenuInflater().inflate(R.menu.popub_menu, popupMenu.getMenu());
        //3.设置点击选项的监听器
        popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() {
            @Override
            public boolean onMenuItemClick(MenuItem item) {
                //点击菜单选项时调用
                Toast.makeText(MainActivity.this, item.getTitle(), Toast.LENGTH_SHORT).show();
                return false;
            }
        });
        //4.显示PopubMenu
        popupMenu.show();
    }

}

```

#### xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    xmlns:android="http://schemas.android.com/apk/res/android">
    <androidx.appcompat.widget.Toolbar
        android:id="@+id/tool_bar"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:title="这是标题"
        android:titleTextColor="@color/colorAccent"
        android:navigationIcon="@drawable/bigiron"
        android:background="@color/colorPrimary"/>
    <Button
        android:id="@+id/btn_toast"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="点击显示toast"/>
    <Button
        android:id="@+id/btn_notification"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="点击发送消息"/>
    <TextView
        android:id="@+id/tv"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="这是要复制的内容"
        android:textSize="30sp"/>
    <EditText
        android:id="@+id/et"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>
    <Button
        android:id="@+id/btn_popubMenu"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="点击弹出PopubMenu"></Button>

</LinearLayout>
```



### 2.Notification

#### 代码见上

### 3.OptionMenu

代码结构

<img src="C:\Users\ShenYayu\AppData\Roaming\Typora\typora-user-images\image-20200606075800062.png" alt="image-20200606075800062" style="zoom: 150%;" />

![image-20200606075828988](C:\Users\ShenYayu\AppData\Roaming\Typora\typora-user-images\image-20200606075828988.png)

#### xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">
    <item android:title="选项菜单一" android:id="@+id/option1"
        app:showAsAction="always"
        android:icon="@drawable/bigiron">
        <!-- 子菜单  -->
        <menu>
            <item android:title="子选项一" android:id="@+id/sub_option1"></item>
            <item android:title="子选项一" android:id="@+id/sub_option2"></item>
        </menu>
    </item>
    <item android:title="选项菜单二" android:id="@+id/option2"></item>
    <group android:id="@+id/group">
        <item android:title="分组子选项一" android:id="@+id/group_option1"></item>
        <item android:title="分组子选项一" android:id="@+id/group_option2"></item>
    </group>
</menu>

```

### 4.ContextMenu

#### xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
<item android:title="复制" android:id="@+id/copy"></item>
<item android:title="粘贴" android:id="@+id/paste"></item>
</menu>
```

### 5.PopupMenu

#### xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:title="弹出菜单选项一" android:id="@+id/option01"/>
    <item android:title="弹出菜单选项一" android:id="@+id/option02"/>
</menu>
```

### 6.ActionBar和ToolBar

#### style.xml

```xml
<resources>
    <!-- Base application theme. -->
    <style name="AppTheme" parent="Theme.AppCompat.Light.NoActionBar">
	<!--NoActionbar去掉默认的标题栏， DarkActionBar:默认的标题栏，整个应用程序-->
        <!-- Customize your theme here. -->
        <item name="colorPrimary">@color/colorPrimary</item>
        <item name="colorPrimaryDark">@color/colorPrimaryDark</item>
        <item name="colorAccent">@color/colorAccent</item>
    </style>

</resources>

```

